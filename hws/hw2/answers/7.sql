with myrowset as (select rank() over (partition by category order by maxplaytime desc) as therank, * from (select designers.designer as designer,categories.category as category, games.maxplaytime as maxplaytime from designers, desgame, gamecat, categories, games where designers.des_id = desgame.des_id and desgame.g_id = gamecat.g_id and gamecat.g_id = games.g_id and gamecat.c_id = categories.c_id order by category)as a) select distinct designer, category, maxplaytime as max from myrowset where therank = 1 order by category desc;
